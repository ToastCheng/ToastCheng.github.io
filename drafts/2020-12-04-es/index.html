<!doctype html><html lang=en-us><head><title>ShihCheng Tu</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=description content="bulk create data put
curl -X PUT &#34;localhost:9200/library/book/_bulk?refresh&pretty&#34; -H 'Content-Type: application/json' -d' {&#34;index&#34;:{&#34;_id&#34;: &#34;Leviathan Wakes&#34;}} {&#34;name&#34;: &#34;Leviathan Wakes&#34;, &#34;author&#34;: &#34;James S."><meta property="og:title" content><meta property="og:description" content="bulk create data put
curl -X PUT &#34;localhost:9200/library/book/_bulk?refresh&pretty&#34; -H 'Content-Type: application/json' -d' {&#34;index&#34;:{&#34;_id&#34;: &#34;Leviathan Wakes&#34;}} {&#34;name&#34;: &#34;Leviathan Wakes&#34;, &#34;author&#34;: &#34;James S."><meta property="og:type" content="article"><meta property="og:url" content="https://toastcheng.github.io/drafts/2020-12-04-es/"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="bulk create data put
curl -X PUT &#34;localhost:9200/library/book/_bulk?refresh&pretty&#34; -H 'Content-Type: application/json' -d' {&#34;index&#34;:{&#34;_id&#34;: &#34;Leviathan Wakes&#34;}} {&#34;name&#34;: &#34;Leviathan Wakes&#34;, &#34;author&#34;: &#34;James S."><meta itemprop=name content><meta itemprop=description content="bulk create data put
curl -X PUT &#34;localhost:9200/library/book/_bulk?refresh&pretty&#34; -H 'Content-Type: application/json' -d' {&#34;index&#34;:{&#34;_id&#34;: &#34;Leviathan Wakes&#34;}} {&#34;name&#34;: &#34;Leviathan Wakes&#34;, &#34;author&#34;: &#34;James S."><meta itemprop=wordCount content="777"><meta itemprop=keywords content><link rel=canonical href=https://toastcheng.github.io/drafts/2020-12-04-es/><link rel=icon type=image/png href=https://toastcheng.github.ioimage/favicon.ico><link rel=stylesheet href=/css/font-awesome.min.css><link rel=stylesheet href=/css/bulma.min.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-168042428-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=/js/ramium.js></script><link rel=stylesheet href=/css/ramium.css></head><body><nav class="navbar is-dark" role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=/><strong>ShihCheng Tu</strong></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=/>Home</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>This Blog</a><div class=navbar-dropdown><a class=navbar-item href=/tags/>All Tags</a>
<a class=navbar-item href=/sections/>All Sections</a>
<a class=navbar-item href=/posts/>All Posts</a></div></div><a class=navbar-item href=/author/>Author</a></div><div class=navbar-end><a class="navbar-item navgithub" href=https://github.com/toastcheng/ target=_blank><i class="fa fa-github fa-2x"></i></a><div class=navbar-item><form id=cse-search-box-form-id onsubmit="return executeQuery();" role=search><div class="field has-addons"><div class="control is-expanded"><input id=cse-search-input-box-id size=15 class=input type=text autocomplete=off placeholder="&#xf1a0; Google search" style=font-family:Arial,FontAwesome></div><div class=control><button type=submit class="button is-black">
<i class="fa fa-search"></i></a></button></div></div></form></div></div></div></nav><div class="columns is-centered"><div id=page-body class="column is-7"><div class="content blog"><h1></h1><div id=infobar class="level is-mobile"><div class=level-left><div class=level-item><p class="subtitle info date">Jan 1, 0001</p></div><div class=level-item><p class="subtitle info">4 mins read</p></div></div><div class="level-right is-hidden-touch"><div class=tags></div></div></div><div class="tags is-hidden-desktop"></div><div class=blog-text><h3 id=bulk-create-data>bulk create data</h3><p>put</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -X PUT <span style=color:#e6db74>&#34;localhost:9200/library/book/_bulk?refresh&amp;pretty&#34;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d<span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{&#34;index&#34;:{&#34;_id&#34;: &#34;Leviathan Wakes&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;Leviathan Wakes&#34;, &#34;author&#34;: &#34;James S.A. Corey&#34;, &#34;release_date&#34;: &#34;2011-06-02&#34;, &#34;page_count&#34;: 561}
</span><span style=color:#e6db74>{&#34;index&#34;:{&#34;_id&#34;: &#34;Hyperion&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;Hyperion&#34;, &#34;author&#34;: &#34;Dan Simmons&#34;, &#34;release_date&#34;: &#34;1989-05-26&#34;, &#34;page_count&#34;: 482}
</span><span style=color:#e6db74>{&#34;index&#34;:{&#34;_id&#34;: &#34;Dune&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;Dune&#34;, &#34;author&#34;: &#34;Frank Herbert&#34;, &#34;release_date&#34;: &#34;1965-06-01&#34;, &#34;page_count&#34;: 604}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><p>post</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XPOST <span style=color:#e6db74>&#39;localhost:9200/fruit/_bulk&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;nanaba&#34;, &#34;price&#34;: 100}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;banana&#34;, &#34;price&#34;: 100}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;bamboo&#34;, &#34;price&#34;: 100}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;apple&#34;, &#34;price&#34;: 150}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;pineapple&#34;, &#34;price&#34;: 20}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;strawberry&#34;, &#34;price&#34;: 90}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;watermellon&#34;, &#34;price&#34;: 200}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;kiwi&#34;, &#34;price&#34;: 50}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;kibana&#34;, &#34;price&#34;: 50}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;pine&#34;, &#34;price&#34;: 20}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;application&#34;, &#34;price&#34;: 150}
</span><span style=color:#e6db74>{&#34;index&#34;: { &#34;_index&#34;: &#34;fruit&#34;}}
</span><span style=color:#e6db74>{&#34;name&#34;: &#34;ppa&#34;, &#34;price&#34;: 150}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><h3 id=get-all-indexes>get all indexes</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>GET /_cat/indices
GET /_cat/indices?v <span style=color:#75715e># verbose</span>
</code></pre></div><p>Returns</p><pre><code>health  status  index uuid  pri rep docs.count  docs.deleted store.size  pri.store.size
yellow  open    fruit Nnj_o9MZRHK4EoB88Z1eFA  1 1 0 0 208b  208b
</code></pre><h3 id=create-index-index-is-automatically-created-with-document>create index (index is automatically created with document)</h3><p><a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-create-index.html>Doc</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XPUT <span style=color:#e6db74>&#39;localhost:9200/fruit&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;settings&#34;: {
</span><span style=color:#e6db74>    &#34;number_of_replicas&#34;: 1,
</span><span style=color:#e6db74>    &#34;number_of_shards&#34;: 1,
</span><span style=color:#e6db74>    &#34;analysis&#34;: {},
</span><span style=color:#e6db74>    &#34;refresh_interval&#34;: &#34;1s&#34;
</span><span style=color:#e6db74>  },
</span><span style=color:#e6db74>  &#34;mappings&#34;: {
</span><span style=color:#e6db74>    &#34;dynamic&#34;: false,
</span><span style=color:#e6db74>    &#34;properties&#34;: {
</span><span style=color:#e6db74>      &#34;title&#34;: {
</span><span style=color:#e6db74>        &#34;type&#34;: &#34;text&#34;,
</span><span style=color:#e6db74>        &#34;analyzer&#34;: &#34;english&#34;
</span><span style=color:#e6db74>      }
</span><span style=color:#e6db74>    }
</span><span style=color:#e6db74>  }
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><h3 id=create-doc>create doc</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XPUT <span style=color:#e6db74>&#39;localhost:9200/&lt;index&gt;/_doc/&lt;doc&gt;&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;name&#34;: &#34;banana&#34;,
</span><span style=color:#e6db74>  &#34;price&#34;: 123
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><h3 id=copy-documents-from-index-to-index>copy documents from index to index</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XPOST <span style=color:#e6db74>&#39;localhost:9200/_reindex&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;source&#34;: {
</span><span style=color:#e6db74>    &#34;index&#34;: &lt;origin&gt;
</span><span style=color:#e6db74>  },
</span><span style=color:#e6db74>  &#34;dest&#34;: {
</span><span style=color:#e6db74>    &#34;index&#34;: &lt;new&gt;
</span><span style=color:#e6db74>  }
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><h3 id=search-prefix-autocomplete>search prefix (autocomplete)</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XGET <span style=color:#e6db74>&#39;localhost:9200/fruit/_search?pretty&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;query&#34;: {
</span><span style=color:#e6db74>    &#34;match_phrase_prefix&#34;: {
</span><span style=color:#e6db74>      &#34;name&#34;: {
</span><span style=color:#e6db74>          &#34;query&#34;: &#34;ki&#34;,
</span><span style=color:#e6db74>          &#34;slop&#34;: 10
</span><span style=color:#e6db74>      }
</span><span style=color:#e6db74>    }
</span><span style=color:#e6db74>  }
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><p>N-gram
add autocomplete analyzer to an index
*note before applying changes, close the index first:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XPOST <span style=color:#e6db74>&#39;localhost:9200/fruit/_close&#39;</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XPUT <span style=color:#e6db74>&#39;localhost:9200/fruit/_settings?pretty&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;analysis&#34;: {
</span><span style=color:#e6db74>    &#34;filter&#34;: {
</span><span style=color:#e6db74>      &#34;autocomplete_filter&#34;: {
</span><span style=color:#e6db74>        &#34;type&#34;: &#34;edge_ngram&#34;,
</span><span style=color:#e6db74>        &#34;min_gram&#34;: 1,
</span><span style=color:#e6db74>        &#34;max_gram&#34;: 20
</span><span style=color:#e6db74>      }
</span><span style=color:#e6db74>    },
</span><span style=color:#e6db74>    &#34;analyzer&#34;: {
</span><span style=color:#e6db74>      &#34;autocomplete&#34;: {
</span><span style=color:#e6db74>        &#34;type&#34;: &#34;custom&#34;,
</span><span style=color:#e6db74>        &#34;tokenizer&#34;: &#34;standard&#34;,
</span><span style=color:#e6db74>        &#34;filter&#34;: [&#34;lowercase&#34;, &#34;autocomplete_filter&#34;]
</span><span style=color:#e6db74>      }
</span><span style=color:#e6db74>    }
</span><span style=color:#e6db74>  }
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><p>test it a little bit:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XGET <span style=color:#e6db74>&#39;localhost:9200/fruit/_analyze?pretty&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;analyzer&#34;: &#34;autocomplete&#34;,
</span><span style=color:#e6db74>  &#34;text&#34;: &#34;kiwi&#34;
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
<span style=color:#75715e># return:</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;tokens&#34;</span> : <span style=color:#f92672>[</span>
    <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;token&#34;</span> : <span style=color:#e6db74>&#34;k&#34;</span>,
      <span style=color:#e6db74>&#34;start_offset&#34;</span> : 0,
      <span style=color:#e6db74>&#34;end_offset&#34;</span> : 4,
      <span style=color:#e6db74>&#34;type&#34;</span> : <span style=color:#e6db74>&#34;&lt;ALPHANUM&gt;&#34;</span>,
      <span style=color:#e6db74>&#34;position&#34;</span> : <span style=color:#ae81ff>0</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;token&#34;</span> : <span style=color:#e6db74>&#34;ki&#34;</span>,
      <span style=color:#e6db74>&#34;start_offset&#34;</span> : 0,
      <span style=color:#e6db74>&#34;end_offset&#34;</span> : 4,
      <span style=color:#e6db74>&#34;type&#34;</span> : <span style=color:#e6db74>&#34;&lt;ALPHANUM&gt;&#34;</span>,
      <span style=color:#e6db74>&#34;position&#34;</span> : <span style=color:#ae81ff>0</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;token&#34;</span> : <span style=color:#e6db74>&#34;kiw&#34;</span>,
      <span style=color:#e6db74>&#34;start_offset&#34;</span> : 0,
      <span style=color:#e6db74>&#34;end_offset&#34;</span> : 4,
      <span style=color:#e6db74>&#34;type&#34;</span> : <span style=color:#e6db74>&#34;&lt;ALPHANUM&gt;&#34;</span>,
      <span style=color:#e6db74>&#34;position&#34;</span> : <span style=color:#ae81ff>0</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;token&#34;</span> : <span style=color:#e6db74>&#34;kiwi&#34;</span>,
      <span style=color:#e6db74>&#34;start_offset&#34;</span> : 0,
      <span style=color:#e6db74>&#34;end_offset&#34;</span> : 4,
      <span style=color:#e6db74>&#34;type&#34;</span> : <span style=color:#e6db74>&#34;&lt;ALPHANUM&gt;&#34;</span>,
      <span style=color:#e6db74>&#34;position&#34;</span> : <span style=color:#ae81ff>0</span>
    <span style=color:#f92672>}</span>
  <span style=color:#f92672>]</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>apply to mapping of index:
*<a href=https://stackoverflow.com/questions/28761372/updating-analyzer-within-elasticsearch-settings>caveat</a></p><blockquote><p>Although you can add new types to an index, or add new fields to a type, you can’t add new analyzers or make changes to existing fields. If you were to do so, the data that had already been indexed would be incorrect and your searches would no longer work as expected.</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XPUT <span style=color:#e6db74>&#39;localhost:9200/fruit/_mapping&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;properties&#34;: {
</span><span style=color:#e6db74>    &#34;name&#34;: {
</span><span style=color:#e6db74>      &#34;type&#34;: &#34;text&#34;,
</span><span style=color:#e6db74>      &#34;analyzer&#34;: &#34;autocomplete&#34;
</span><span style=color:#e6db74>    }
</span><span style=color:#e6db74>  }
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><p>query:
analyzer:</p><ul><li>query time analyzer</li><li>index time analyzer
<a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-index-search-time.html>Index and search analysis</a>
in query time, we should specify the analyzer to &lsquo;standard&rsquo; so we will not split the query string into N-gram:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XGET <span style=color:#e6db74>&#39;localhost:9200/fruit/_search?pretty&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;query&#34;: {
</span><span style=color:#e6db74>    &#34;match&#34;: {
</span><span style=color:#e6db74>      &#34;name&#34;: { &#34;query&#34;: &#34;app bar car&#34;, &#34;analyzer&#34;: &#34;standard&#34; }
</span><span style=color:#e6db74>    }
</span><span style=color:#e6db74>  }
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><h3 id=sort>sort</h3><p>can only sort on field that exists in mapping</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XGET <span style=color:#e6db74>&#39;localhost:9200/fruit/_search?pretty&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;query&#34;: {
</span><span style=color:#e6db74>    &#34;match&#34;: {
</span><span style=color:#e6db74>      &#34;name&#34;: { &#34;query&#34;: &#34;app bar car&#34;, &#34;analyzer&#34;: &#34;standard&#34; }
</span><span style=color:#e6db74>    }
</span><span style=color:#e6db74>  },
</span><span style=color:#e6db74>  &#34;sort&#34;: {
</span><span style=color:#e6db74>    &#34;price&#34;: &#34;asc&#34;
</span><span style=color:#e6db74>  }
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><p>add the price to mapping</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -XPUT <span style=color:#e6db74>&#39;localhost:9200/fruit/_mapping&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>  &#34;properties&#34;: {
</span><span style=color:#e6db74>    &#34;price&#34;: {
</span><span style=color:#e6db74>      &#34;type&#34;: &#34;integer&#34;
</span><span style=color:#e6db74>    }
</span><span style=color:#e6db74>  }
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><p><a href="https://kb.objectrocket.com/elasticsearch/when-to-use-the-keyword-type-vs-text-datatype-in-elasticsearch#:~:text=The%20primary%20difference%20between%20the,fields%20are%20indexed%20as%20is.">string are deprecated</a>:</p><ul><li>text: will be analyzed (may be analyzed by n-gram and so on)</li><li>keyword: will not be analyzed<ul><li>use case: enum or state perhaps</li></ul></li></ul><p><a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-refresh.html>?refresh</a></p><ul><li>true (or empty string)
make the update visible to others immediately (including replicas)
use wisely! might lead to performance issue
=> putting more load on Elasticsearch</li><li>wait_for
will block until when it is visible
=> waiting longer for the response</li></ul><blockquote><p>true creates less efficient indexes constructs (tiny segments) that must later be merged into more efficient index constructs (larger segments). Meaning that the cost of true is paid at index time to create the tiny segment, at search time to search the tiny segment, and at merge time to make the larger segments.</p></blockquote></div></div><div id=social-media-share class=has-text-centered><p><i>Sharing is caring!</i></p><br><div class=share-buttons><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftoastcheng.github.io%2fdrafts%2f2020-12-04-es%2f" onclick="socialMediaPopUp(this.href,'',500,500);return false;" title="Share on Facebook. Opens in a new window."><img src=/img/icons/45px/facebook.png></a>
<a href="https://twitter.com/intent/tweet?text=&url=https%3a%2f%2ftoastcheng.github.io%2fdrafts%2f2020-12-04-es%2f" onclick="socialMediaPopUp(this.href,'',500,500);return false;" title="Share on Twitter. Opens in a new window."><img src=/img/icons/45px/twitter.png></a>
<a href="http://www.reddit.com/submit?url=https%3a%2f%2ftoastcheng.github.io%2fdrafts%2f2020-12-04-es%2f" onclick="socialMediaPopUp(this.href,'',900,500);return false;" title="Share on Reddit. Opens in a new window."><img src=/img/icons/45px/reddit.png></a>
<a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftoastcheng.github.io%2fdrafts%2f2020-12-04-es%2f" onclick="socialMediaPopUp(this.href,'',900,500);return false;" title="Share on Pinterest. Opens in a new window."><img src=/img/icons/45px/pinterest.png></a>
<a href="http://www.tumblr.com/share/link?url=https%3a%2f%2ftoastcheng.github.io%2fdrafts%2f2020-12-04-es%2f" onclick="socialMediaPopUp(this.href,'',900,500);return false;" title="Share on Tumblr. Opens in a new window."><img src=/img/icons/45px/tumblr.png></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ftoastcheng.github.io%2fdrafts%2f2020-12-04-es%2f
			&title=&summary=bulk%20create%20data%20put%0acurl%20-X%20PUT%20%26%2334%3blocalhost%3a9200%2flibrary%2fbook%2f_bulk%3frefresh%26amp%3bpretty%26%2334%3b%20-H%20%26%2339%3bContent-Type%3a%20application%2fjson%26%2339%3b%20-d%26%2339%3b%20%7b%26%2334%3bindex%26%2334%3b%3a%7b%26%2334%3b_id%26%2334%3b%3a%20%26%2334%3bLeviathan%20Wakes%26%2334%3b%7d%7d%20%7b%26%2334%3bname%26%2334%3b%3a%20%26%2334%3bLeviathan%20Wakes%26%2334%3b%2c%20%26%2334%3bauthor%26%2334%3b%3a%20%26%2334%3bJames%20S.&source=rafed123.github.io" onclick="socialMediaPopUp(this.href,'',900,500);return false;" title="Share on LinkedIn. Opens in a new window."><img src=/img/icons/45px/linkedin.png></a>
<a href="mailto:?subject=&body=Check out this site https%3a%2f%2ftoastcheng.github.io%2fdrafts%2f2020-12-04-es%2f" title="Share via Email. Opens in a new window."><img src=/img/icons/45px/mail.png></a></div></div><br><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='toastcheng';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div><script async src="https://cse.google.com/cse.js?cx=Engineering%20blog"></script><gcse:searchresults-only></gcse:searchresults-only><footer class="footer has-background-dark"><div class="content has-text-centered has-text-white"><p>© 2020 Ramium. Powered by
<a class=has-text-light href=https://github.com/gohugoio/hugo target=_blank>Hugo</a>. Theme
<a class=has-text-light href=https://github.com/rafed123/ramium/ target=_blank>Ramium.</a></p></div></footer></body></html>