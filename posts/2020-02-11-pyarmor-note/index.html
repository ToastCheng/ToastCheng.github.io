<!doctype html><html lang=en-us><head><title>Pyarmor: Obfuscate Your Python Source Code |
ShihCheng Tu</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=description content="Pyarmor is a tool that helps you obfuscate your python source code in a jiffy."><meta property="og:title" content="Pyarmor: Obfuscate your python source code"><meta property="og:description" content="Pyarmor is a tool that helps you obfuscate your python source code in a jiffy."><meta property="og:type" content="article"><meta property="og:url" content="https://toastcheng.github.io/posts/2020-02-11-pyarmor-note/"><meta property="article:published_time" content="2020-02-11T23:13:54+08:00"><meta property="article:modified_time" content="2020-02-11T23:13:54+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pyarmor: Obfuscate your python source code"><meta name=twitter:description content="Pyarmor is a tool that helps you obfuscate your python source code in a jiffy."><meta itemprop=name content="Pyarmor: Obfuscate your python source code"><meta itemprop=description content="Pyarmor is a tool that helps you obfuscate your python source code in a jiffy."><meta itemprop=datePublished content="2020-02-11T23:13:54+08:00"><meta itemprop=dateModified content="2020-02-11T23:13:54+08:00"><meta itemprop=wordCount content="440"><meta itemprop=keywords content="note,pyarmor,obfuscate,security,"><link rel=canonical href=https://toastcheng.github.io/posts/2020-02-11-pyarmor-note/><link rel=icon type=image/png href=https://toastcheng.github.ioimage/favicon.ico><link rel=stylesheet href=/css/font-awesome.min.css><link rel=stylesheet href=/css/bulma.min.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-168042428-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=/js/ramium.js></script><link rel=stylesheet href=/css/ramium.css></head><body><nav class="navbar is-dark" role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=/><strong>ShihCheng Tu</strong></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=/>Home</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>This Blog</a><div class=navbar-dropdown><a class=navbar-item href=/tags/>All Tags</a>
<a class=navbar-item href=/sections/>All Sections</a>
<a class=navbar-item href=/posts/>All Posts</a></div></div><a class=navbar-item href=/author/>Author</a></div><div class=navbar-end><a class="navbar-item navgithub" href=https://github.com/toastcheng/ target=_blank><i class="fa fa-github fa-2x"></i></a><div class=navbar-item><form id=cse-search-box-form-id onsubmit="return executeQuery();" role=search><div class="field has-addons"><div class="control is-expanded"><input id=cse-search-input-box-id size=15 class=input type=text autocomplete=off placeholder="&#xf1a0; Google search" style=font-family:Arial,FontAwesome></div><div class=control><button type=submit class="button is-black">
<i class="fa fa-search"></i></a></button></div></div></form></div></div></div></nav><div class="columns is-centered"><div id=page-body class="column is-7"><div class="content blog"><h1>Pyarmor: Obfuscate Your Python Source Code</h1><div id=infobar class="level is-mobile"><div class=level-left><div class=level-item><p class="subtitle info date">Feb 11, 2020</p></div><div class=level-item><p class="subtitle info">3 mins read</p></div></div><div class="level-right is-hidden-touch"><div class=tags><a class="tag is-dark is-rounded" href=/tags/note>Note</a>
<a class="tag is-dark is-rounded" href=/tags/pyarmor>Pyarmor</a>
<a class="tag is-dark is-rounded" href=/tags/obfuscate>Obfuscate</a>
<a class="tag is-dark is-rounded" href=/tags/security>Security</a></div></div></div><div class="tags is-hidden-desktop"><a class="tag is-dark is-rounded" href=/tags/note>Note</a>
<a class="tag is-dark is-rounded" href=/tags/pyarmor>Pyarmor</a>
<a class="tag is-dark is-rounded" href=/tags/obfuscate>Obfuscate</a>
<a class="tag is-dark is-rounded" href=/tags/security>Security</a></div><div class=blog-text><p><a href=https://pyarmor.readthedocs.io/en/latest/index.html>Pyarmor</a> is a tool that helps you obfuscate your python source code in a jiffy.</p><h2 id=usage>Usage</h2><ul><li>Main usage &ndash; obfuscate</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pyarmor obfuscate foo.py
</code></pre></div><p>This will generate <code>dist</code> with structure:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>dist
├── pytransform
│   ├── __init__.py
│   ├── _pytransform.dylib
│   ├── license.lic
│   └── pytransform.key
└── foo.py
</code></pre></div><p>The dist is simply a module that perform exact the same functionality without source code.
By changeing the name of entry file to <code>__main__.py</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mv foo.py __main__.py
</code></pre></div><p>And add a output flag <code>--output</code> to specify the output dir name:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pyarmor obfuscate --output<span style=color:#f92672>=</span>foo foo.py
</code></pre></div><p>The <code>dist</code> becomes:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>foo
├── pytransform
│   ├── __init__.py
│   ├── _pytransform.dylib
│   ├── license.lic
│   └── pytransform.key
└── __main__.py
</code></pre></div><p>Then you can run <code>python foo</code>, same as <code>python foo.py</code> with the source code.</p><ul><li>Add license
If one use <code>pyarmor obfuscate foo.py</code> to generate code, there is a <code>license.lic</code> inside <code>dist/pytransform</code> with no limitation. But running the obfuscated code needs the present of this file. To add more limitation to the license, you can use <code>pyarmor licenses</code>:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pyarmor licenses <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --bind-disk <span style=color:#e6db74>&#34;100304PBN2081SF3NJ5T&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --bind-mac <span style=color:#e6db74>&#34;20:c1:d2:2f:a0:96&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --expired 2020-01-01 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  code_name

<span style=color:#75715e># then replace the origin license.</span>
cp licenses/code_name/license.lic dist/pytransform/
cd dist/
python foo.py
</code></pre></div><p>However, in free trial mode, everyone who knows how to use pyarmor can generate a license himself and replace the original one.</p><ul><li>Multiple platform (<a href=https://pyarmor.readthedocs.io/en/latest/advanced.html#running-obfuscated-scripts-in-multiple-platforms>doc</a>)</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pyarmor obfuscate <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --platform windows.x86_64 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --platform linux.x86_64 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --platform darwin.x86_64 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  foo.py
</code></pre></div><p>To view the whole supported platform: <a href=https://pyarmor.readthedocs.io/en/latest/platforms.html#standard-platform-names>here</a></p><ul><li>Recursively obfuscate</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pyarmor obfuscate <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --recursive <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --output dist <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  foo.py
</code></pre></div><h2 id=security>Security</h2><ul><li>PyArmor obfuscate each function separately, then obfuscate the whole module. At runtime restore the current called function will be restored, and obfuscate immediately after call is completed.</li><li>Cross protection <code>_pytransform</code>
a dynamic library generated at obfuscate time.<ul><li>Checked (checksum) by the obfuscated code</li><li>JIT mechanism<ul><li>Define an instruction set base on GNU lightning.</li><li>Generate core functions by instruction set in C.</li></ul></li><li>Other protections, at runtime, <code>_pytransform.so</code> will generate code from function 1 and run it with several protection approach.<ul><li>Run function 1:<ul><li>check codesum of code segment, if not expected, quit</li><li>check tickcount, if too long, quit</li><li>check there is any debugger, if found, quit</li><li>clear hardware breakpoints if possible</li><li>restore next function function 2</li></ul></li><li>Run function 2&mldr; same as step 1.</li></ul></li></ul></li><li>Limitations of free trial<ul><li>The maximum size of code object is 35728 bytes in trial version</li><li>The scripts obfuscated by trial version are not private. It means anyone could generate the license file which works for these obfuscated scripts.</li><li>Without permission the trial version may not be used for the Python scripts of any commercial product.</li><li><a href="https://order.shareit.com/cart/add?vendorid=200089125&PRODUCT%5B300871197%5D=1">Purchase (TWD1,387.69)</a></li></ul></li><li>Obfuscation step<ul><li>Compile python script to code object, save to file.</li></ul></li></ul></div></div><div id=social-media-share class=has-text-centered><p><i>Sharing is caring!</i></p><br><div class=share-buttons><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ftoastcheng.github.io%2fposts%2f2020-02-11-pyarmor-note%2f" onclick="socialMediaPopUp(this.href,'',500,500);return false;" title="Share on Facebook. Opens in a new window."><img src=/img/icons/45px/facebook.png></a>
<a href="https://twitter.com/intent/tweet?text=Pyarmor%3a%20Obfuscate%20your%20python%20source%20code&url=https%3a%2f%2ftoastcheng.github.io%2fposts%2f2020-02-11-pyarmor-note%2f" onclick="socialMediaPopUp(this.href,'',500,500);return false;" title="Share on Twitter. Opens in a new window."><img src=/img/icons/45px/twitter.png></a>
<a href="http://www.reddit.com/submit?url=https%3a%2f%2ftoastcheng.github.io%2fposts%2f2020-02-11-pyarmor-note%2f" onclick="socialMediaPopUp(this.href,'',900,500);return false;" title="Share on Reddit. Opens in a new window."><img src=/img/icons/45px/reddit.png></a>
<a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ftoastcheng.github.io%2fposts%2f2020-02-11-pyarmor-note%2f" onclick="socialMediaPopUp(this.href,'',900,500);return false;" title="Share on Pinterest. Opens in a new window."><img src=/img/icons/45px/pinterest.png></a>
<a href="http://www.tumblr.com/share/link?url=https%3a%2f%2ftoastcheng.github.io%2fposts%2f2020-02-11-pyarmor-note%2f" onclick="socialMediaPopUp(this.href,'',900,500);return false;" title="Share on Tumblr. Opens in a new window."><img src=/img/icons/45px/tumblr.png></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ftoastcheng.github.io%2fposts%2f2020-02-11-pyarmor-note%2f
			&title=Pyarmor%3a%20Obfuscate%20your%20python%20source%20code&summary=Pyarmor%20is%20a%20tool%20that%20helps%20you%20obfuscate%20your%20python%20source%20code%20in%20a%20jiffy.&source=rafed123.github.io" onclick="socialMediaPopUp(this.href,'',900,500);return false;" title="Share on LinkedIn. Opens in a new window."><img src=/img/icons/45px/linkedin.png></a>
<a href="mailto:?subject=Pyarmor%3a%20Obfuscate%20your%20python%20source%20code&body=Check out this site https%3a%2f%2ftoastcheng.github.io%2fposts%2f2020-02-11-pyarmor-note%2f" title="Share via Email. Opens in a new window."><img src=/img/icons/45px/mail.png></a></div></div><br><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='toastcheng';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div><script async src="https://cse.google.com/cse.js?cx=Engineering%20blog"></script><gcse:searchresults-only></gcse:searchresults-only><footer class="footer has-background-dark"><div class="content has-text-centered has-text-white"><p>© 2020 Ramium. Powered by
<a class=has-text-light href=https://github.com/gohugoio/hugo target=_blank>Hugo</a>. Theme
<a class=has-text-light href=https://github.com/rafed123/ramium/ target=_blank>Ramium.</a></p></div></footer></body></html>